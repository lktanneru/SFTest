<template>

    <c-spinner is-loading={isLoading}></c-spinner> 
    <!-- Section to show Mandatory core standar or not -->
    <div class="combo slds-size_small" style="margin-left: 80%;">
        <template if:true={mancorestd}>
            <p style="color: red;"><strong>* Mandatory Core Standard</strong></p>
        </template>
    </div>
    <template if:true={selectedtabname}>
        <!-- This lightning-accordion has 4 sections
                         1.Guidance  
                         2. Tasks
                         3. Min standard and evidence
                         4. Explanation and good Practices
                         5. progress bar -->
        <lightning-accordion allow-multiple-sections-open active-section-name="ProgressBar">

            <!-- "Guidance" section starts here -->
            <lightning-accordion-section name="Guidance" label="Guidance">
                <template if:true={coreStandardList}>
                    <template for:each={coreStandardList} for:item="core">
                        <p key={core.Id}><b style="color:green; font-size:150%;">Core Standard
                                {core.Core_Standard_Number__c}: {core.Name}</b>
                            <br /><br /><lightning-formatted-url value={core.Document_Ref__c}
                                label={core.Document_Ref__c} target="_blank"></lightning-formatted-url>
                            <br /><br /> <b> {core.Description__c}</b>
                            <br /><br /> <lightning-formatted-rich-text
                                value={core.Guidance__c}></lightning-formatted-rich-text>
                        </p>
                    </template>
                </template>
            </lightning-accordion-section>

            <!-- Tasks section start here      -->
            <lightning-accordion-section name="Tasks" label="Tasks">

                <table class="slds-table slds-table_cell-buffer slds-table_edit slds-no-row-hover"
                    aria-label="List of Tasks">
                    <!--TASK TABLE HEADER-->
                    <thead>
                        <tr class="slds-line-height_reset">
                            <th class="" scope="col">
                                <div class="slds-truncate slds-m-left_small" title="Key Task">Key Task <a
                                        style="color: red;">
                                        *</a></div>
                            </th>
                            <th class="" scope="col">
                                <div class="slds-truncate slds-m-left_small" title="Due Date">Due Date <a
                                        style="color: red;">
                                        *</a></div>
                            </th>
                            <th class="" scope="col">
                                <div class="slds-truncate slds-m-left_small" title="Completion Date">Completion date (only if task already completed)
                                </div>
                            </th>
                            <th class="" scope="col">
                                <div class="slds-truncate slds-m-left_small" title="Person Responsible">Person
                                    Responsible <a style="color: red;">
                                        *</a>
                                </div>
                            </th>

                            <template if:true={implementflag}>
                                <th class="" scope="col">
                                    <div class="slds-truncate slds-m-left_small" title="Status">Status</div>
                                </th>
                                <th class="" scope="col">
                                    <div class="slds-truncate slds-m-left_small" title="Comments/Updates">
                                        Comments/Updates
                                    </div>
                                </th>
                            </template>
                            <th class="" scope="col">
                                <lightning-button-icon icon-name="utility:add" alternative-text="Add"
                                    class="slds-m-left_xx-small slds-align_absolute-center" title="Add"
                                    onclick={handleaddRow} variant="brand">
                                </lightning-button-icon>
                            </th>
                        </tr>
                    </thead>
                    <!--TASK TABLE BODY-->
                    <tbody>
                        <template for:each={taskRecList} for:item="task">
                            <tr key={task.key}>
                                <td>
                                    <lightning-textarea name="KeyTask" type="text" id={task.key}
                                        onchange={handleonchange} value={task.Key_Task__c}>
                                    </lightning-textarea>
                                </td>
                                <td>
                                    <lightning-input name="DueDate" type="date" id={task.key} onchange={handleonchange}
                                        value={task.Due_Date__c}>
                                    </lightning-input>
                                </td>
                                <td>
                                    <lightning-input name="TaskCompletionDate" id={task.key} type="date"
                                        onchange={handleonchange} value={task.Completion_Date__c}>
                                    </lightning-input>
                                </td>
                                <td>
                                    <lightning-input name="PersonResponsible" type="text" id={task.key}
                                        onchange={handleonchange} value={task.Person_Responsible_For_The_Activity__c}>
                                    </lightning-input>
                                </td>
                                <template if:false={implementflag}>
                                    <template if:false={task.Id}>
                                        <td>
                                            <lightning-button-icon icon-name="utility:delete"
                                                        alternative-text="Delete"
                                                        class="save-button-container"
                                                        title="Delete" onclick={deleteTasks}
                                                        data-id={task.key}>
                                            </lightning-button-icon>
                                        </td>
                                    </template>
                                </template>

                                <template if:true={implementflag}>
                                    <td>
                                        <template if:true={taskOptions}>
                                            <lightning-combobox name="Status" id={task.key} onchange={handleChange}
                                                value={task.Status__c} options={taskOptions}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <lightning-textarea name="comments" access-key={task.key} id={task.key}
                                            type="text" onchange={handleonchange} value={task.Comments__c}>
                                        </lightning-textarea>

                                    </td>

                                    <td>
                                
                                        <template if:false={task.Id}>
                                            <lightning-button-icon icon-name="utility:delete"
                                                alternative-text="Delete"
                                                class="save-button-container"
                                                title="Delete" onclick={deleteTasks}
                                                data-id={task.key}>
                                            </lightning-button-icon>
                                        </template>

                                    </td>
                                </template>
                            </tr>
                        </template>
                    </tbody>
                </table>
                <!-- Task Table Ends -->
                <lightning-button variant="success" label="Save Task" class="slds-align_absolute-center"
                    onclick={handleonsave}> </lightning-button>
            </lightning-accordion-section>
            <!-- Min std and Evidence section starts here         -->
            <template if:true={implementflag}>
                <lightning-accordion-section name="MinStdEvidence" label="Minimum Standard and Evidence"
                    onsectiontoggle={handleMinimumStdEvid2}>
                    <table
                        class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered slds-table_edit"
                        aria-label="List of Tasks">
                        <tbody>
                            <template for:each={QuestionMin} for:item="question" for:index="index">
                                <tr key={KeyIndex}>
                                    <td>
                                        <div class="slds-list_horizontal slds-wrap question ">
                                            <p>{question.QuestionNum}. {question.Question__c}</p>
                                            <template if:true={question.isMandatory}>
                                                <span class="asterisk">*</span>
                                            </template>
                                        </div>
                                        <!-- Yes/No Questions -->
                                        <template if:true={question.isSuccess}>
                                            <lightning-radio-group name={question.Question_id} options={RadioOption}
                                                onchange={ansOptions} value={question.retAns} type="radio"
                                                data-id={question.Question__c}>
                                            </lightning-radio-group>
                                        </template>
                                        <!-- Qustions with file Upload -->

                                        <template if:true={question.isLink}>
                                            <lightning-radio-group name={question.Question_id} options={RadioOption}
                                                onchange={ansOptions} value={question.retAns} type="radio"
                                                data-id={question.Question__c}>
                                            </lightning-radio-group>
                                            <!-- <template if:true={showComponents}> -->
                                                    <div class="slds-m-around_medium">

                                                        <c-file-uploader-comp-lwc aura-id="fileupload"
                                                            record-id={submissionid} file-name={question.FileNameQues}
                                                            oncallpasstoparent={passToParent}
                                                            label="<a>Upload</a>">
                                                        </c-file-uploader-comp-lwc>
                                                    </div>  

                                                    <div class="boxAlign">
                                                        <!--added by Cheely-->
                                                        <lightning-button label="Box"
                                                            variant="brand" onclick={OpenBoxDetails}
                                                            name={question.QuesId} style="margin-top:8px">
                                                        </lightning-button>
                                                        <p></p>
                                                    </div>
                                                        <!--added by Cheely-->
                                           
                                            <br />
                                            <!-- </template> -->
                                        </template>

                                        <!-- Descriptive Questions -->
                                        <template if:true={question.isAns}>
                                            <div class="slds-p-around_medium lgc-bg">
                                                <lightning-textarea value={question.retDescAns}
                                                    name={question.Question_id} onchange={ansOptions}>
                                                </lightning-textarea>
                                            </div>
                                        </template>
                                        <!-- Training Table  -->
                                        <template if:true={question.isTrainingLink}>
                                            <br />
                                            <div class="slds-align_absolute-center slds-m-top_large" style="color:blue">
                                                <h1><strong> Safeguarding Trainings For Staff And Related
                                                        Personnel</strong></h1>
                                            </div>
                                            <!-- class="slds-table slds-table_cell-buffer slds-table_edit slds-no-row-hover" -->
                                            <!-- class="custom-table slds-m-top_large slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered slds-table_fixed-layout" -->
                                                <table class="slds-table slds-table_cell-buffer slds-table_edit slds-no-row-hover"
                                                
                                                    
                                                    aria-label="List of Tasks">
                                                    <!--Training TABLE-->
                                                    <thead>
                                                        <tr class="slds-line-height_reset">
                                                            <th class="heading-center" scope="col" colspan="2">
                                                                <div title="Date of training">Date of
                                                                    training</div>
                                                            </th>
                                                            <th class="heading-center" scope="col" colspan="4">
                                                                <div class="slds-truncate" title="Training Description">
                                                                    Training Description</div>
                                                            </th>
                                                            <th class="heading-center" scope="col" colspan="2">
                                                                <div class="slds-truncate"
                                                                    title="Did the training cover?">
                                                                    Did the training cover?</div>
                                                            </th>
                                                            <th class="heading-center" scope="col" colspan="12">
                                                                <div class="slds-truncate"
                                                                    title="Training Participants">
                                                                    Training Participants</div>
                                                            </th>
                                                            <th class="heading-center" scope="col" colspan="6">
                                                                <div class="slds-truncate" title="Evidence">Evidence
                                                                </div>
                                                            </th>
                                                            <th class="heading-center" scope="col" colspan="1">
                                                                <lightning-button-icon variant="brand"
                                                                    icon-name="utility:add" alternative-text="Add"
                                                                    class="slds-m-left_xx-small" title="Add"
                                                                    onclick={addTrainingRow}>
                                                                </lightning-button-icon>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <!-- class="flex-container" -->
                                                        <template for:each={trainingList} for:item="item">
                                                            <tr key={item.key} class="trainrow">
                                                                <td class="cell" colspan="2">
                                                                    <div class="body-cell">
                                                                        <lightning-datepicker name="TrainingDate" type="Date"
                                                                            id={item.key}
                                                                            title={item.Name}
                                                                            onchange={handletrainingonchange}
                                                                            value={item.Date_Of_Training__c} 
                                                                            required>
                                                                        </lightning-datepicker>
                                                                    </div>
                                                                </td>
                                                                <td class="cell" colspan="4">
                                                                    <div class="flex-container slds-p-around_small">
                                                                       
                                                                            <lightning-textarea name="TrainingDesc"
                                                                            type="text" id={item.key}
                                                                            label="Description of training"
                                                                            onchange={handletrainingonchange}
                                                                            value={item.Description_Of_Training__c}>
                                                                        </lightning-textarea>
                                                                       
                                                                        
                                                                        
                                                                            <lightning-input name="TrainingDelivered"
                                                                            type="text" id={item.key}
                                                                            label="Who delivered the training?"
                                                                            onchange={handletrainingonchange}
                                                                            value={item.Who_Delivered_the_Training__c}
                                                                            required>
                                                                        </lightning-input>
                                                                       
                                                                        
                                                                    </div>
                                                                </td>
                                                                <td class="cell" colspan="2">
                                                                    <div class="slds-grid slds-grid_vertical slds-p-around_small">
                                                                        <div class="slds-col">
                                                                        <lightning-radio-group name={item.radioKey0}
                                                                            label="Safeguarding Policy?" id={item.key}
                                                                            onchange={handletrainingonchange}
                                                                            options={RadioOption}
                                                                            value={item.Safeguarding_Policy__c}
                                                                            type="radio">
                                                                        </lightning-radio-group>
                                                                    </div>
                                                                    <div class="slds-col">
                                                                        <lightning-radio-group name={item.radioKey1}
                                                                            label="PSEA Policy?" id={item.key}
                                                                            onchange={handletrainingonchange}
                                                                            options={RadioOption}
                                                                            value={item.PSEA_Policy__c} type="radio">
                                                                        </lightning-radio-group>
                                                                    </div>
                                                                    <div class="slds-col">
                                                                        <lightning-radio-group name={item.radioKey2}
                                                                            label="Code of Conduct?" id={item.key}
                                                                            onchange={handletrainingonchange}
                                                                            options={RadioOption}
                                                                            value={item.Code_of_Conduct__c}
                                                                            type="radio">
                                                                        </lightning-radio-group>
                                                                    </div>
                                                                    </div>
                                                                </td>
                                                                <td class="cell" colspan="12">
                                                                    <div class="slds-grid slds-grid_vertical">
                                                                        <div class="slds-col">
                                                                            <lightning-input name="NumOxfamStaff"
                                                                            title="Number of Oxfam staff"
                                                                            id={item.key} type="number"
                                                                            placeholder="Number of Oxfam staff"
                                                                            onchange={handletrainingonchange}
                                                                            value={item.Number_of_Oxfam_staff__c}>
                                                                        </lightning-input>
                                                                        </div>
                                                                        
                                                                        <div class="slds-col">
                                                                            <lightning-input name="NumPartr" id={item.key}
                                                                            type="number" title="Number of Partner Staff"
                                                                            placeholder="Number of Partner Staff"
                                                                            onchange={handletrainingonchange}
                                                                            value={item.Number_of_partners__c}>
                                                                        </lightning-input>
                                                                        </div>
                                                                        
                                                                        <div class="slds-col">
                                                                            <lightning-input name="NumComm" id={item.key}
                                                                            type="number" placeholder="Number of community"
                                                                            onchange={handletrainingonchange}
                                                                            value={item.Number_of_community__c}>
                                                                        </lightning-input>
                                                                        </div>
                                                                        
                                                                        <div class="slds-col">
                                                                            <lightning-input name="TotTrained" id={item.key}
                                                                            type="number" placeholder="TOTAL trained"
                                                                            value={item.Total_Trained_Staff__c}
                                                                            class={item.totClass} data-name="temptotal"
                                                                            disabled>
                                                                        </lightning-input>
                                                                        </div>
                                                                        
                                                                    </div>
                                                                </td>
                                                                
                                                                <td class="cell" colspan="6">
                                                                    <div style="margin-left:10px;">
                                                                        <div>
                                                                            <div>
                                                                                <label>Attendance Sheet</label>
                                                                            </div>
                                    
                                                                            <lightning-layout size="1">
                                                                                <lightning-layout-item
                                                                                    
                                                                                    size="1" style="margin-bottom: 1px;">
                                                                                    <c-file-uploader-comp-lwc
                                                                                        
                                                                                        record-id={submissionid}
                                                                                        extended-name="Attendance Sheet"
                                                                                        file-name={item.Name}
                                                                                        que-name ={item.questionName}
                                                                                        evidence-type={item.EvidenceType}
                                                                                        training-id ={item.Id}
                                                                                        coming-from ="Training"
                                                                                        oncallpasstoparent={passToParent}
                                                                                        label="<a>Upload</a>">
                                                                                    </c-file-uploader-comp-lwc>
                                                                                </lightning-layout-item>
                                                                            </lightning-layout>
                                                                            <lightning-layout size="1">
                                                                                <lightning-layout-item
                                                                                    size="1">
                                                                                    <lightning-button
                                                                                        label="Box"
                                                                                        variant="brand"
                                                                                        onclick={openTrainingBox}
                                                                                        name="Attendance Sheet"
                                                                                        data-id={item.Id}
                                                                                        data-value={submissionid}
                                                                                        queid = {item.Question__c}
                                                                                        style="margin-top:8px">
                                                                                    </lightning-button>
                                                                                </lightning-layout-item>
                                                                            </lightning-layout>
                                                                        </div>
                                                                        <div>
                                                                            <div>
                                                                                <label>Training materials</label>
                                                                            </div>
                                                                            <lightning-layout size="1">
                                                                                <lightning-layout-item
                                                                                    size="1" style="margin-bottom: 1px;">
                                                                                    <c-file-uploader-comp-lwc
                                                                                        record-id={submissionid}
                                                                                        extended-name="Training materials"
                                                                                        coming-from ="Training"
                                                                                        training-id ={item.Id}
                                                                                        que-name ={item.questionName}
                                                                                        evidence-type={item.EvidenceType}
                                                                                        file-name={item.Name}
                                                                                        oncallpasstoparent={passToParent}
                                                                                        label="<a>Upload</a>">
                                                                                    </c-file-uploader-comp-lwc>
                                                                                </lightning-layout-item>
                                                                            </lightning-layout>
                                                                            <lightning-layout size="1">
                                                                                <lightning-layout-item
                                                                                    
                                                                                    size="1">
                                                                                    <lightning-button
                                                                                        label="Box"
                                                                                        variant="brand"
                                                                                        onclick={openTrainingBox}
                                                                                        data-value={submissionid}
                                                                                        name="Training materials"
                                                                                        queid = {item.Question__c}
                                                                                        data-id={item.Id}
                                                                                        style="margin-top:8px">
                                                                                    </lightning-button>
                                                                                </lightning-layout-item>
                                                                            </lightning-layout>
                                                                        </div>
                                                                        <div>
                                                                            <div>
                                                                                <label>Other evidence</label>
                                                                            </div>
                                                                            <lightning-layout size="1">
                                                                                <lightning-layout-item size="1" style="margin-bottom: 1px;">
                                                                                    <c-file-uploader-comp-lwc
                                                                                        record-id={submissionid}
                                                                                        extended-name="Other evidence"
                                                                                        coming-from ="Training"
                                                                                        training-id ={item.Id}
                                                                                        que-name ={item.questionName}
                                                                                        evidence-type={item.EvidenceType}
                                                                                        file-name={item.Name}
                                                                                        oncallpasstoparent={passToParent}
                                                                                        label="<a>Upload</a>">
                                                                                    </c-file-uploader-comp-lwc>
                                                                                </lightning-layout-item>
                                                                            </lightning-layout>
                                                                            <lightning-layout size="1">
                                                                                <lightning-layout-item size="1">
                                                                        
                                                                                    <lightning-button
                                                                                        label="Box"
                                                                                        variant="brand"
                                                                                        onclick={openTrainingBox}
                                                                                        name="Other evidence"
                                                                                        data-value={submissionid}
                                                                                        data-id={item.Id}
                                                                                        queid = {item.Question__c}
                                                                                        style="margin-top:8px">
                                                                                    </lightning-button>
                                                                                </lightning-layout-item>
                                                                            </lightning-layout>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td colspan="1">
                                                                    <div class="flex-container">
                                                                        <lightning-button-icon
                                                                            icon-name="utility:delete"
                                                                            alternative-text="Delete"
                                                                            class="slds-m-left_xx-small slds-align_absolute-center"
                                                                            title="Delete" onclick={delTraining}
                                                                            data-id={item.key}>
                                                                        </lightning-button-icon>
                                                                    </div>
                                                                </td>

                                                            </tr>
                                                        </template>
                                                    </tbody>
                                                </table>
                                         
                                            <lightning-button class="slds-align_absolute-center slds-m-around_small"
                                                label="Save Training Details" variant="success" align="center"
                                                onclick={btnSaveTraining}>
                                            </lightning-button>
                                        </template>
                                        <!-- Partner Table -->
                                        <template if:true={question.isPartnerLink}>
                                            <div class="slds-align_absolute-center slds-m-top_large"
                                                style="color:blue;">
                                                <h1><strong> Partner Table</strong></h1>
                                            </div>

                                            <table
                                                class="slds-table slds-table_cell-buffer slds-table_edit slds-no-row-hover"
                                                
                                                aria-label="Partner Table">
                                                <!--class="chdTable slds-table_resizable-cols slds-m-top_large slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered custom-table slds-table_fixed-layout"-->

                                                <!--PARTNER TABLE-->
                                                <thead>
                                                    <tr class="slds-line-height_reset slds-is-resizable">
                                                        <th class="header-cell">
                                                            <div class="slds-wrap slds-m-around_xx-small slds-resizable"
                                                                title="Partner Name">Partner Name
                                                            </div>
                                                        </th>
                                                        <th class="header-cell slds-is-resizable">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="Project(s) Partner is Involved in">Project(s)
                                                                Partner is Involved in </div>
                                                        </th>
                                                        <th class="header-cell">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="Partner since (year in which partnership started)">
                                                                Partner
                                                                since </div>
                                                        </th>
                                                        <th class="header-cell">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="Contact or Working with Children">Contact or
                                                                Working with Children </div>
                                                        </th>
                                                        <th class="header-cell" colspan="2">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="CS and PSEA in Partner Capacity Assessment">CS
                                                                and PSEA in Partner Capacity Assessment </div>
                                                        </th>
                                                        <th class="header-cell" colspan="2">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="CS and PSEA in Partner Working Agreement ">CS and
                                                                PSEA in Partner Working Agreement </div>
                                                        </th>
                                                        <th class="header-cell" colspan="2">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="Partner Code of Conduct or equivalent Signed">
                                                                Partner Code of Conduct or equivalent Signed </div>
                                                        </th>
                                                        <th class="header-cell" colspan="2">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="CS and PSEA Policy in Place">CS and PSEA Policy
                                                                in Place </div>
                                                        </th>
                                                        <th class="header-cell" colspan="10">
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="Date of the last CS training">Date of the last CS
                                                                training </div>
                                                        </th>
                                                        <th class="header-cell" colspan="10"> 
                                                            <div class="slds-wrap slds-m-around_xx-small"
                                                                title="Date of the last PSEA training ">Date of the last
                                                                PSEA training </div>
                                                        </th>
                                                        <th style="text-align: center; max-width: 60px;height: 10px">
                                                            <lightning-button-icon icon-name="utility:add"
                                                                alternative-text="Add"
                                                                class="slds-m-left_medium slds-align_absolute-center"
                                                                title="Add" onclick={addPartnerRow} variant="brand">
                                                            </lightning-button-icon>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- class="slds-size_small custom-input" -->
                                                    <template for:each={partnerList} for:item="item">
                                                        <tr key={item.key}>
                                                            <td class="body-cell">
                                                                <lightning-textarea name="PartnerName" type="text"
                                                                    
                                                                    id={item.key} data-key={item.key}
                                                                    style="margin-top:10px;" 
                                                                    onchange={handlePartnerOnChange} value={item.Name} required>
                                                                </lightning-textarea>
                                                            </td>
                                                            <td class="body-cell">
                                                                <lightning-textarea name="PartnerInvolvedIn" type="text"
                                                                    id={item.key} data-key={item.key}
                                                                    onchange={handlePartnerOnChange}
                                                                    value={item.Project_s_Partner_is_Involved_in__c}>
                                                                </lightning-textarea>
                                                            </td>
                                                            <td class="body-cell" style='width:1px'>
                                                                <lightning-input name="PartnerSince" type="text"
                                                                    max-length="4" id={item.key} data-key={item.key}
                                                                    style="margin-top:10px"
                                                                    onchange={handlePartnerOnChange}
                                                                    value={item.Partner_since__c} placeholder="Year">
                                                                </lightning-input>
                                                            </td>
                                                            <td>
                                                                <lightning-combobox class="slds-size_small custom-input"
                                                                    name="ContactOrChildren"
                                                                    onchange={handlePartnerOnChange}
                                                                    options={partnerOptions}
                                                                    value={item.Contact_or_Working_with_Children__c}
                                                                    id={item.key}>
                                                                </lightning-combobox>
                                                            </td>
                                                            <td colspan="2">
                                                                <lightning-radio-group name={item.radioKey0}
                                                                    id={item.key} data-key={item.key}
                                                                    onchange={handlePartnerOnChange}
                                                                    options={RadioOption}
                                                                    value={item.CS_PSEA_in_Partner_Capacity_Assessment__c}
                                                                    type="radio">
                                                                </lightning-radio-group>

                                                            </td>
                                                            <td colspan="2">
                                                                <lightning-radio-group name={item.radioKey1}
                                                                    id={item.key} data-key={item.key}
                                                                    onchange={handlePartnerOnChange}
                                                                    options={RadioOption}
                                                                    value={item.CS_PSEA_in_Partner_Working_Agreement__c}
                                                                    type="radio">
                                                                </lightning-radio-group>
                                                            </td>
                                                            <td colspan="2">
                                                                <lightning-radio-group name={item.radioKey2}
                                                                    id={item.key} data-key={item.key}
                                                                    onchange={handlePartnerOnChange}
                                                                    options={RadioOption}
                                                                    value={item.PartnerCodeofConductorequivalentSigned__c}
                                                                    type="radio">
                                                                </lightning-radio-group>
                                                            </td>
                                                            <td colspan="2">
                                                                <lightning-radio-group name={item.radioKey3}
                                                                    id={item.key} data-key={item.key}
                                                                    onchange={handlePartnerOnChange}
                                                                    options={RadioOption}
                                                                    value={item.CS_and_PSEA_Policy_in_Place__c}
                                                                    type="radio">
                                                                </lightning-radio-group>
                                                            </td>
                                                            <td colspan="10">
                                                                <!--<lightning-input name="CSTrainingDate" type="date"-->
                                                                <lightning-datepicker name="CSTrainingDate"
                                                                    id={item.key} data-key={item.key}
                                                                    style="margin-top:10px"
                                                                    onchange={handlePartnerOnChange}
                                                                    value={item.Date_of_the_last_CS_training__c}>
                                                                </lightning-datepicker>
                                                                <!--</lightning-input>-->
                                                            </td>
                                                            <td colspan="10">
                                                                <lightning-input name="PSEATrainingDate" type="date"
                                                                    id={item.key} data-key={item.key}
                                                                    style="margin-top:10px"
                                                                    onchange={handlePartnerOnChange}
                                                                    value={item.Date_of_the_last_PSEA_training__c}>
                                                                </lightning-input>
															</td>
                                                            <td >
                                                                <lightning-button-icon icon-name="utility:delete"
                                                                    alternative-text="Delete"
                                                                    class="save-button-container"
                                                                    title="Delete" onclick={delPartner}
                                                                    data-id={item.key}>
                                                                </lightning-button-icon>
                                                            </td>
                                                        </tr>
                                                    </template>
                                                </tbody>
                                            </table>
                                            <div>
                                                <lightning-button class="slds-align_absolute-center slds-m-around_small "
                                                label="Save Partner Details" variant="success" align="center"
                                                onclick={btnSavePartner}>
                                            </lightning-button>
                                            </div>
                                            
                                        </template>
                                        <!-- Project Table -->
                                        <template if:true={question.isProjectLink}>

                                            <div class="slds-m-top_large slds-align_absolute-center"
                                                style="color:blue;">
                                                <h1><strong> Projects Risk Assessments Table</strong></h1>
                                            </div>
                                            <!-- class="slds-m-top_large slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered custom-table slds-table_fixed-layout" -->
                                                <table 
                                                class="slds-table slds-table_cell-buffer slds-table_edit slds-no-row-hover"
                                                    
                                                    aria-label="Project Table">

                                                    <thead>
                                                        <tr class="slds-line-height_reset">
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                     title="Project Name">Project
                                                                    Name
                                                                </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                     title="Project start date">
                                                                    Project start date </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                    title="Project End date">
                                                                    Project
                                                                    End date </div>
                                                            </th>
                                                            <!-- max-width: 60px;height:10px style="text-align: center; max-width: 100px;height:10px"-->
                                                            <th class="header-cell">
                                                                <div class=""
                                                                    title="What level of contact with children do the project activities involve?">
                                                                    What level of contact with children do the project
                                                                    activities involve? </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                    title="Is the Risk Assessment completed ">Is the
                                                                    Risk
                                                                    Assessment completed </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                    title="Were the partners involved in Risk Assessment? ">
                                                                    Were the partners involved in Risk Assessment?
                                                                </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                    title="When was the last review/update of Risk Assessment?">
                                                                    When was the last review/update of Risk Assessment?
                                                                </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                    title="What progress has been made on monitoring High Risk Activities in the Risk Assessment since the last report?">
                                                                    What progress has been made on monitoring High Risk
                                                                    Activities in the Risk Assessment since the last
                                                                    report?
                                                                </div>
                                                            </th>
                                                            <th class="header-cell">
                                                                <div class="slds-wrap slds-m-around_xx-small"
                                                                    title="If no Risk Assessment has been completed, please provide an explanation">
                                                                    If no Risk Assessment has been completed, please
                                                                    provide
                                                                    an explanation </div>
                                                            </th>
                                                            <!-- style="text-align: center; max-width: 100px;height:10px" -->
                                                            <th
                                                                >
                                                                <lightning-button-icon icon-name="utility:add"
                                                                    alternative-text="Add"
                                                                    class="slds-m-left_medium max-width: 100px;height:10px"
                                                                    title="Add" variant="brand" onclick={addProjectRow}>
                                                                </lightning-button-icon>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <template for:each={projectList} for:item="item">
                                                            <tr key={item.key}>
                                                                <td class="body-cell">
                                                                    <lightning-textarea name="ProjectName" type="text"
                                                                        id={item.key} data-key={item.key}
                                                                        style="margin-top:10px;"
                                                                        onchange={handleProjectOnChange}
                                                                        value={item.Name} required>
                                                                    </lightning-textarea>
                                                                </td>
                                                                <td class="body-cell">
                                                                    <lightning-datepicker name="ProjectStart" type="date"
                                                                        id={item.key} data-key={item.key}
                                                                        style="margin-top:10px;"
                                                                        onchange={handleProjectOnChange}
                                                                        value={item.Project_Start_Date__c}>
                                                                    </lightning-datepicker>
                                                                </td>
                                                                <td class="body-cell">
                                                                    <lightning-datepicker name="ProjectDate" type="date"
                                                                        id={item.key} data-key={item.key}
                                                                        style="margin-top:10px;"
                                                                        onchange={handleProjectOnChange}
                                                                        value={item.Project_End_Date__c}>
                                                                    </lightning-datepicker>
                                                                </td> 
                                                                <td class="body-cell">
                                                                    <div class="picklist-container">
                                                                        <lightning-combobox name="LevelOfContact"
                                                                            onchange={handleProjectOnChange}
                                                                            options={partnerOptions}
                                                                            value={item.What_level_of_contact_with_children_do__c}
                                                                            id={item.key}>
                                                                        </lightning-combobox>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                   
                                                                    <lightning-radio-group name={item.radioKey0}
                                                                        id={item.key} data-key={item.key}
                                                                        onchange={handleProjectOnChange}
                                                                        options={RadioOption}
                                                                        value={item.Is_the_Risk_Assessment_completed__c}
                                                                        type="radio">
                                                                    </lightning-radio-group>
                                                                </td>
                                                                <td>
                                                                   
                                                                    <lightning-radio-group name={item.radioKey1}
                                                                        id={item.key} data-key={item.key}
                                                                        onchange={handleProjectOnChange}
                                                                        options={RadioOption}
                                                                        value={item.partners_involved_in_Risk_Asses__c}
                                                                        type="radio">
                                                                    </lightning-radio-group>
                                                                </td>
                                                                <td class="body-cell">
                                                                    <lightning-textarea name="MonthAndYear" type="text"
                                                                        id={item.key} data-key={item.key}
                                                                        style="margin-top:10px;"
                                                                        onchange={handleProjectOnChange}
                                                                        value={item.When_was_the_last_review_update_of_Risk__c}>
                                                                    </lightning-textarea>
                                                                </td>
                                                                <td class="body-cell">
                                                                    <lightning-textarea name="ProgressRiskActivities"
                                                                        id={item.key} type="textarea"
                                                                        data-key={item.key}
                                                                        onchange={handleProjectOnChange}
                                                                        value={item.Progress_On_Monitoring_High_Risk__c}>
                                                                    </lightning-textarea>
                                                                </td>
                                                                <td class="body-cell">
                                                                    <lightning-textarea name="Explanation" type="text"
                                                                        id={item.key} data-key={item.key}
                                                                        style="margin-top:10px;"
                                                                        onchange={handleProjectOnChange}
                                                                        value={item.If_No_Risk_Assessment_Explain__c}>
                                                                    </lightning-textarea>
                                                                </td>
                                                                <td>
                                                                    <lightning-button-icon icon-name="utility:delete"
                                                                        alternative-text="Delete"
                                                                        class="slds-m-left_xx-small slds-align_absolute-center"
                                                                        title="Delete" onclick={delProject}
                                                                        data-id={item.key}>
                                                                    </lightning-button-icon>
                                                                </td>
                                                            </tr>
                                                        </template>
                                                    </tbody>
                                                </table>

                                            <div>
                                                <lightning-button class="slds-align_absolute-center slds-m-around_small"
                                                    label="Save Project Details" variant="success" align="center"
                                                    onclick={btnSaveProject}>
                                                </lightning-button>
                                            </div>
                                        </template>

                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                
                </lightning-accordion-section>
                <!-- Explanation and Good practices Section     -->
                <lightning-accordion-section name="ExplanationGoodPract" label="Explanation and Good Practices"
                    class="datepicker__month datepicker-table datepicker-table"
                    onsectiontoggle={handleMinimumStdEvid1}>
                    <table
                        class="datepicker__month datepicker-table datepicker-table"
                        aria-label="List of Tasks"> 
                        <!-- class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered slds-table_edit"-->
                        <tbody>
                            <template for:each={Questions} for:item="question" for:index="index">
                                <tr key={KeyIndex}>
                                    <td>
                                        <div class="slds-list_horizontal slds-wrap question">
                                            <p>{question.QuestionNum}. {question.Question__c}</p>
                                            <template if:true={question.isMandatory}>
                                                <span class="asterisk">*</span>
                                            </template>
                                        </div>
                                        <template if:true={question.isSuccess}>
                                            <lightning-radio-group id={question.Question_id} name={question.Question_id}
                                                options={RadioOption} onchange={ansOptions} value={question.retAns} data-id={question.Question__c}
                                                class="yesno" type="radio"></lightning-radio-group>
                                        </template>
                                        <template if:true={question.isLink}>
                                            <lightning-radio-group id={question.Question_id} name={question.Question_id}
                                                options={RadioOption} onchange={ansOptions} value={question.retAns}
                                                type="radio" data-id={question.Question__c}>
                                            </lightning-radio-group>

                                            <div>
                                                <c-file-uploader-comp-lwc record-id={submissionid}
                                                    extended-name="Attach receipt" file-name={question.FileNameQues}
                                                    oncallpasstoparent={passToParent}>
                                                </c-file-uploader-comp-lwc>
                                            </div>
                                        </template>
                                        <div if:true={question.isAns}>
                                                <!--<div class="slds-wrap datepicker__month datepicker-table datepicker-table">-->
                                                <lightning-textarea value={question.retDescAns}
                                                    name={question.Question_id} onchange={ansOptions}>
                                                </lightning-textarea>
                                                <!--<lightning-textarea id={textareas} name={question.Question_id} value={question.retDescAns} label="Answer"></lightning-textarea>-->


                                            <!--</div>-->
                                        </div>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                    
                </lightning-accordion-section>
                <!-- Progress bar section     -->
                <lightning-accordion-section name="ProgressBar"
                    label="Indicator of Compliance with this Core Standard's Minimum Standards (based on your saved answers above)"
                    onsectiontoggle={progressBarHandler}>
                    <lightning-progress-bar value={progressBarValue} size="large"
                        variant="circular"></lightning-progress-bar>
                        
                </lightning-accordion-section>
            </template>
        </lightning-accordion>
<!-- save button        -->
        <div class="sticky-footer">
            <lightning-button class="slds-align_absolute-center" label="Save" variant="success"
                align="center" onclick={btnSaveAnswer}>
            </lightning-button>
        </div>
        <template if:true={openLinkPopUp}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                            title="Close" onclick={closeModal}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                                size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Add Links
                        </h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <table class="slds-table slds-no-row-hover slds-table_cell-buffer" role="grid">
                            <tbody>
                                <template for:each={listOfBoxLinks} for:item="rec">
                                    <tr key={rec} class="slds-hint-parent">
                                        <td>
                                            <lightning-input type="text" variant="label-hidden" label=""
                                                data-id={rec.index} name="boxLink" value={rec.boxLink}
                                                onchange={handleInputChange}></lightning-input>
                                        </td>
                                        <td>
                                            <div class="slds-p-left_small slds-p-vertical_small">
                                                <lightning-button-icon icon-name="utility:add"
                                                    onclick={addNewRow}></lightning-button-icon>
                                            </div>
                                        </td>
                                        <td>
                                            <lightning-button-icon icon-name="utility:delete" alternative-text="Remove"
                                                title="Remove" name={rec.index} data-id={rec.boxId}
                                                onclick={removeRow}></lightning-button-icon>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                        <template if:true={showAddButton}>
                            <div class="slds-p-left_small slds-p-vertical_small">
                                <lightning-button icon-name="utility:add" title="Add Rows" label="Add Rows"
                                    onclick={addNewRow}></lightning-button>
                            </div>
                        </template>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick={closeModal}
                            title="Cancel">Cancel</button>
                        <button class="slds-button slds-button_brand" onclick={submitDetails} title="OK">Save
                            Links</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
        <template if:true={openTrainingBoxLink}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                            title="Close" onclick={closeTrainingLink}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                                size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate">Add Links
                        </h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-2">
                        <table class="slds-table slds-no-row-hover slds-table_cell-buffer" role="grid">
                            <tbody>
                                <template for:each={listOfTrainingBoxLinks} for:item="rec">
                                    <tr key={rec} class="slds-hint-parent">
                                        <td>
                                            <lightning-input type="text" variant="label-hidden" label=""
                                                data-id={rec.index} name="boxLink" value={rec.boxLink}
                                                onchange={handleInputTrainingLinkChange}></lightning-input>
                                        </td>
                                        <td>
                                            <div class="slds-p-left_small slds-p-vertical_small">
                                                <lightning-button-icon icon-name="utility:add"
                                                    onclick={addNewTrainingRow}></lightning-button-icon>
                                            </div>
                                        </td>
                                        <td>
                                            <lightning-button-icon icon-name="utility:delete" alternative-text="Remove"
                                                title="Remove" name={rec.index} data-id={rec.boxId}
                                                onclick={removeTrainingRow}></lightning-button-icon>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                        <template if:true={showLinkAddButton}>
                            <div class="slds-p-left_small slds-p-vertical_small">
                                <lightning-button icon-name="utility:add" title="Add Rows" label="Add Rows"
                                    onclick={addNewTrainingRow}></lightning-button>
                            </div>
                        </template>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick={closeTrainingLink}
                            title="Cancel">Cancel</button>
                        <button class="slds-button slds-button_brand" onclick={submitTrainingBoxDetails} title="OK">Save
                            Links</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
    </template>
</template> <!-- Main Template Closing -->